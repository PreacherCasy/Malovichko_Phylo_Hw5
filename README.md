## Hw5_Malovichko


### Цель работы
На этой неделе мы познакомимся с построением филогенетических деревьев методами расстояний: UPGMA и NJ. Данные методы основаны работают скорее как кластеризаторы данных и проигрывают методам, основанным на биологически осмысленных эвристиках (MP, ML). Основным преимуществом методов расстояний является их скорость; при помощи них можно понять приблизительную топологию дерева при наличии качественного выравнивания слабо отличающихся последовательностей.

## Исходные данные
В качестве исходных данных использовалось выравнивание гена терминатора трансляции SUP35 дрожжей *S.cerevisiae*, выполненное при помощи алгоритма *Prank*. 

## Задание 1.
После некоторых попыток разобраться с ete3, MEGA7 (CC-интерфейс) и Bio.Phylo мы решили воспользоваться онлайн-интерфейсом на сайте [Европейского института биоинформатики](https://www.ebi.ac.uk/Tools/phylogeny/simple_phylogeny/). Для обоих построений использовались стандартные настройки.

## Задание 2. 
Визуализацию деревьев см. в репозитории в данном репозитории.
Если топология UPGMA-дерева подтверждает использование Kla-Agos-филы в качестве аутгруппы, то в случае NJ в основании дерева лежит политомический узел с двумя аутгруппами (SUP35_Sarb_H-6_chrXIII_CM001575:0.065077 и
SUP35_Seub_CBS12357_chr_II_IV_DF968535:0.065077):0.06897), при этом монофилия клады сохраняется в обоих случаях. Наличие политомического узла предполагает, что из двух имеющихся именно NJ-дерево является неукорененным. Так как BioNJ принято считать более прогрессивным методом, мы можем предположить, что *Kla-Agos* является сомнительным враиантом аутгруппы.

## Задание 3
Далее мы запустили jModelTest2 в двух разных форматах. Для начала мы воспользовались GUI-версией (см. скрин в репозитории) для 88 моделей (11 substitution schemes). Затем мы решили, что GUI is for pussies и воспользовались следующей командой (оба информационных критерия + включение в анализ моделей с  proportion invariable sites и unequals base frecuencies:

```bash
cd ~/Downloads/jmodeltest-2.1.10/ ; java -jar jModelTest.jar -d <input> -a -i -f -o -AIC -BIC -o <output>
```

HTML-логи приложены в репозитории. По результатам работы программы в качестве оптимальной модели была выбрана GTR+G.

## Задание 4
PartitionFinder работает с форматом PHYLIP. Для конвертирования мы воспользовались [SequenceConverter](http://sequenceconversion.bugaco.com/converter/biology/sequences/fasta_to_phylip.php) (fasta -> phylip, alphabet = DNA). Однако из-за ограничения на количество символов исчезла уникальность имен для некоторых последовательностей. Мы решили эту проблему при помощи gsub:

```bash
sed -i 's/SUP35_//' SUP35_aln.best.fas
```
Или:
```bash
 cat SUP35_aln.best.fas | awk '($0 ~/SUP35_/) {sub("SUP35_","")}'
```
Теперь все очень здорово, но затем выясняется, что нам был нужен relaxed Phylip вместо стандартного. Эту проблему мы решили при помощи [другого конвертера](http://aligner.azurewebsites.net/inputform.html#).

## Задание 5
Запустим PartitionFinder при помощи следующей команды. Поместим файл с выравниванием и файл с партициями в папку for_analysis:
```bash
python2.7 /home/reverend_casy/partitionfinder-2.1.1/PartitionFinder.py /home/reverend_casy/Downloads/Phylo_Proj_5/for_analysis
```
Используем только первую схему партиционирования и "жадный" поиск: 
```
Gene = 1-2460;
search = greedy; 
```
Результат - модель TRN+I+G, что отличается от показаний jModelTest.

## Задание 6
Для выполнения этой задачи достаточно просто убрать из файла с партициями search=greedy. Voila!
Лучшая схема поиска - separate: идущие последовательно позиции для N- и C-терминальных доменов
(NM_pos1) (NM_pos2) (NM_pos3) (C_pos1) (C_pos2) (C_pos3)

## Выводы
1. Алгоритмы, основанные на методах расстояний, подходят для наборов сравнительно идентичны последовательностей. Кроме того, результаты двух алгоритмов значительно различаются между собой: в NJ-дереве появляется политомический узел и теряется положение некой клады как аутгруппы.
2. Мета-анализ, включающий результаты использовавших другие настройки однокурсников, показывает, что поиск модели эволюции как в jModelTest2, так и в PartitionFinder, зависит от используемых критериев (Aikike inference или Bayesian inference), количеством схем замещения, включением в анализ специфических моделей и т.д.
